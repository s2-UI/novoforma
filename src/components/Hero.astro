---
import { Image } from 'astro:assets'

// Seleccionamos algunas imágenes de proyectos para el slider
const heroImages = [
  '/projects/barcelona-balmes/barcelona-balmes-01.jpeg',
  '/projects/barcelona-balmes/barcelona-balmes-03.jpeg',
  '/projects/barcelona-balmes/barcelona-balmes-05.jpeg',
  '/projects/barcelona-balmes/barcelona-balmes-07.jpeg',
]

const heroAlts = [
  'Reforma integral de piso en Barcelona - Salón moderno',
  'Reforma de cocina completa Barcelona',
  'Reforma de baño moderno Barcelona',
  'Espacios reformados Barcelona Novoforma'
]
---

<section class='relative w-full h-screen overflow-hidden bg-zinc-900' role='banner' aria-label='Hero section'>
  <!-- Slider de imágenes de fondo -->
  <div class='absolute inset-0 z-0' role='img' aria-label='Imágenes de proyectos de reformas'>
    {
      heroImages.map((src, index) => (
        <div
          class={`absolute inset-0 transition-opacity duration-1000 ${index === 0 ? 'opacity-100' : 'opacity-0'}`}
          data-slide={index}
        >
          <Image
            src={src}
            alt={heroAlts[index] || `Proyecto de reforma Barcelona ${index + 1} - Novoforma`}
            width={1920}
            height={1080}
            class='w-full h-full object-cover'
            loading={index === 0 ? 'eager' : 'lazy'}
          />
        </div>
      ))
    }
    <!-- Overlay degradado -->
    <div class='absolute inset-0 bg-gradient-to-br from-zinc-950/90 via-zinc-950/70 to-zinc-950/90'></div>
  </div>

  <!-- Contenido principal -->
  <div class='relative z-10 container mx-auto px-4 md:px-6 h-full flex items-center'>
    <div class='max-w-3xl mx-auto text-center text-white'>
      <!-- Badge -->
      <div class='inline-flex items-center gap-2 px-4 py-2 mb-6 bg-primary-600/20 backdrop-blur-sm border border-primary-600/30 rounded-full'>
        <span class='text-xs font-semibold text-primary-300'>+20 Años de Experiencia</span>
      </div>

      <!-- Título -->
      <h1 class='text-4xl font-bold mb-6 tracking-tight sm:text-5xl md:text-6xl lg:text-7xl animate-fade-in'>
        Construcción y Reformas<br />
        <span class='text-primary-400'>de Calidad</span>
      </h1>

      <!-- Descripción -->
      <p class='text-lg md:text-xl text-zinc-300 mb-10 max-w-2xl mx-auto animate-fade-in delay-100'>
        Transforma tu hogar o negocio con nuestros expertos en construcción y reformas. 
        Soluciones personalizadas con los más altos estándares de calidad.
      </p>

      <!-- Botones CTA -->
      <div class='flex flex-col sm:flex-row gap-4 justify-center items-center animate-fade-in delay-200'>
        <a
          href='#contacto'
          class='group relative px-8 py-4 bg-primary-600 text-white font-semibold rounded-sm hover:bg-primary-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl'
        >
          <span class='relative z-10'>Obtener Presupuesto</span>
          <div class='absolute inset-0 bg-primary-500 rounded-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur'></div>
        </a>
        <a
          href='#galeria'
          class='px-8 py-4 border-2 border-white/20 text-white font-semibold rounded-sm hover:border-white/40 hover:bg-white/10 transition-all duration-300 backdrop-blur-sm'
        >
          Ver Proyectos
        </a>
      </div>

      <!-- Indicadores (dots) -->
      <div class='flex gap-2 justify-center mt-12'>
        {
          heroImages.map((_, index) => (
            <button
              class={`w-2 h-2 rounded-full transition-all duration-300 ${index === 0 ? 'bg-primary-600 w-8' : 'bg-white/40 hover:bg-white/60'}`}
              data-dot={index}
              aria-label={`Slide ${index + 1}`}
            ></button>
          ))
        }
      </div>
    </div>
  </div>

  <!-- Script para el slider automático -->
  <script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
      const slides = document.querySelectorAll('[data-slide]');
      const dots = document.querySelectorAll('[data-dot]');
      let currentSlide = 0;
      const totalSlides = slides.length;

      function goToSlide(index) {
        // Ocultar todas las slides
        slides.forEach((slide, i) => {
          slide.classList.toggle('opacity-0', i !== index);
          slide.classList.toggle('opacity-100', i === index);
        });

        // Actualizar dots
        dots.forEach((dot, i) => {
          if (i === index) {
            dot.classList.remove('w-2', 'bg-white/40');
            dot.classList.add('w-8', 'bg-primary-600');
          } else {
            dot.classList.remove('w-8', 'bg-primary-600');
            dot.classList.add('w-2', 'bg-white/40');
          }
        });

        currentSlide = index;
      }

      // Navegación por dots
      dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
          goToSlide(index);
        });
      });

      // Auto-play cada 5 segundos
      setInterval(() => {
        const nextSlide = (currentSlide + 1) % totalSlides;
        goToSlide(nextSlide);
      }, 5000);

      // Pausar en hover
      const heroSection = document.querySelector('[data-slide]')?.closest('section');
      let intervalId = setInterval(() => {
        const nextSlide = (currentSlide + 1) % totalSlides;
        goToSlide(nextSlide);
      }, 5000);

      if (heroSection) {
        heroSection.addEventListener('mouseenter', () => clearInterval(intervalId));
        heroSection.addEventListener('mouseleave', () => {
          intervalId = setInterval(() => {
            const nextSlide = (currentSlide + 1) % totalSlides;
            goToSlide(nextSlide);
          }, 5000);
        });
      }
    });
  </script>

  <!-- Estilos de animación -->
  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fade-in 1s ease-out forwards;
    }

    .delay-100 {
      animation-delay: 0.2s;
      opacity: 0;
    }

    .delay-200 {
      animation-delay: 0.4s;
      opacity: 0;
    }
  </style>
</section>
